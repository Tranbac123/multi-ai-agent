groups:
- name: chat-adapters-alerts
  rules:
  - alert: Chat_AdaptersHighErrorRate
    expr: rate(http_requests_total{service="chat-adapters",status=~"5.."}[5m]) / rate(http_requests_total{service="chat-adapters"}[5m])
      * 100 > 5
    for: 2m
    labels:
      severity: critical
      service: chat-adapters
      team: platform
    annotations:
      summary: chat-adapters has high error rate
      description: Error rate for chat-adapters is { $value }% which is above the
        5% threshold.
      runbook_url: https://runbooks.company.com/chat-adapters#high-error-rate
  - alert: Chat_AdaptersHighLatency
    expr: histogram_quantile(0.95, rate(http_request_duration_seconds_bucket{service="chat-adapters"}[5m]))
      > 0.2
    for: 5m
    labels:
      severity: warning
      service: chat-adapters
      team: platform
    annotations:
      summary: chat-adapters has high latency
      description: P95 latency for chat-adapters is { $value }s which is above the
        200ms threshold.
      runbook_url: https://runbooks.company.com/chat-adapters#high-latency
  - alert: Chat_AdaptersServiceDown
    expr: up{service="chat-adapters"} == 0
    for: 1m
    labels:
      severity: critical
      service: chat-adapters
      team: platform
    annotations:
      summary: chat-adapters is down
      description: chat-adapters has been down for more than 1 minute.
      runbook_url: https://runbooks.company.com/chat-adapters#service-down
  - alert: Chat_AdaptersHighMemoryUsage
    expr: container_memory_usage_bytes{container="chat-adapters"} / container_spec_memory_limit_bytes{container="chat-adapters"}
      * 100 > 80
    for: 5m
    labels:
      severity: warning
      service: chat-adapters
      team: platform
    annotations:
      summary: chat-adapters has high memory usage
      description: Memory usage for chat-adapters is { $value }% which is above 80%.
      runbook_url: https://runbooks.company.com/chat-adapters#high-memory
